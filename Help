# Predict class probabilities
load_probs = model_load.predict_proba(X_test)
discharge_probs = model_discharge.predict(X_test)

# Extract the top 3 predictions for load country
top3_load_indices = load_probs.argsort(axis=1)[:, -3:]
top3_load_probs = np.sort(load_probs, axis=1)[:, -3:]

# Extract the top 3 predictions for discharge country
top3_discharge_indices = discharge_probs.argsort(axis=1)[:, -3:]
top3_discharge_probs = np.sort(discharge_probs, axis=1)[:, -3:]

# Convert indices to class labels
top3_load_labels = le_load.inverse_transform(top3_load_indices)
top3_discharge_labels = le_discharge.inverse_transform(top3_discharge_indices)

# Combine labels and probabilities for a comprehensive view
top3_load_predictions = [(labels, probs) for labels, probs in zip(top3_load_labels, top3_load_probs)]
top3_discharge_predictions = [(labels, probs) for labels, probs in zip(top3_discharge_labels, top3_discharge_probs)]
